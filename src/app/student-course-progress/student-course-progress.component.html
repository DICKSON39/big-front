<!-- ğŸ”„ Loading & Error Handling -->
<div *ngIf="isLoading" class="loading-text">â³ Loading your progress...</div>
<div *ngIf="errorMessage" class="error-text">âŒ {{ errorMessage }}</div>

<!-- ğŸ“š Display Course Progress -->
<div *ngIf="!isLoading && courses.length > 0; else noCourses">
  <div *ngFor="let course of courses" class="course-progress-card">
    <h2>{{ course.title }}</h2>
    <p>ğŸ¯ Progress: {{ getProgressPercent(course) }}%</p>

    <!-- ğŸ“ Certificate Download -->
    <!-- ğŸ“ Show cert if progress is 100% -->
<!-- ğŸ“ Certificate Download -->
<div 
  *ngIf="course.progress === 100 && course.certificate_url" 
  class="cert-section"
>
  <a 
    [href]="course.certificate_url" 
    target="_blank" 
    rel="noopener noreferrer" 
    download 
    class="cert-download-btn"
  >
    ğŸ“ Download Certificate
  </a>
</div>



    <!-- ğŸ”µ Progress Bar -->
    <div class="progress-bar-container">
      <div
        class="progress-bar-fill"
        [style.width.%]="getProgressPercent(course)"
      ></div>
    </div>

    <!-- ğŸ¥ Course Classes -->
    <ul class="class-list">
      <li *ngFor="let cls of course.classes">
        <strong>{{ cls.title }}</strong>
        <span *ngIf="cls.is_completed" class="status completed">âœ… Completed</span>
        <span *ngIf="!cls.is_completed" class="status pending">â³ Not Completed</span>

        <button (click)="watchClass(cls)">â–¶ï¸ Watch</button>
      </li>
    </ul>
  </div>
</div>

<!-- ğŸ¬ Video Modal -->
<div class="video-modal" *ngIf="selectedClass">
  <div class="modal-content">
    <h3>{{ selectedClass.title }}</h3>

    <video
      width="100%"
      height="auto"
      controls
      [src]="selectedClass.video_url"
      (ended)="onVideoEnded(selectedClass.id, selectedCourse)"
    ></video>

    <div class="video-actions">
      <button (click)="markAsComplete(selectedClass.id, selectedCourse)">
        âœ… Mark as Watched
      </button>
      <button class="cancel" (click)="closeVideo()">âŒ Close</button>
    </div>
  </div>
</div>

<!-- ğŸ”• Empty State -->
<ng-template #noCourses>
  <p class="empty-state">ğŸ“­ You are not enrolled in any courses yet.</p>
</ng-template>
